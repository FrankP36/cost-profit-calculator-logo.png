<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>DeTech | Cost vs. Profit Margin Calculator</title>
<style>
  :root{
    --bg:#0f172a;      /* slate-900 */
    --panel:#111827;   /* gray-900 */
    --muted:#94a3b8;   /* slate-400 */
    --text:#e5e7eb;    /* gray-200 */
    --accent:#22c55e;  /* green-500 */
    --accent-2:#38bdf8;/* sky-400 */
    --warn:#f59e0b;    /* amber-500 */
    --danger:#ef4444;  /* red-500 */
    --card:#0b1220;
    --input:#0b1020;
    --border:#1f2a44;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
    background: radial-gradient(1200px 800px at 80% -10%, #102340 0%, #0b1220 40%, #070c16 100%);
    color: var(--text);
    position: relative;
  }

  /* Logo */
  .logo {
    position: absolute;
    top: 16px;
    left: 32px;
    height: 50px;
    width: auto;
  }

  header{
    padding: 24px 16px 8px;
    text-align:center;
  }
  h1{
    margin:0;
    font-size: clamp(20px, 4vw, 28px);
    letter-spacing: .2px;
  }
  p.sub{
    margin:.35rem 0 0;
    color: var(--muted);
    font-size: 14px;
  }
  .container{
    max-width: 1100px;
    margin: 0 auto;
    padding: 16px;
    display: grid;
    grid-template-columns: 1fr;
    gap: 16px;
  }
  @media (min-width: 980px){
    .container{
      grid-template-columns: 1.05fr .95fr;
      align-items: start;
    }
  }
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0));
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,.25);
  }
  .section-title{
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 12px;
    color: #dbeafe;
  }
  .grid{
    display: grid;
    gap: 10px;
  }
  .grid-2{
    grid-template-columns: 1fr 1fr;
  }
  .row{
    display:flex;
    gap:10px;
  }
  label{
    font-size: 12px;
    color: var(--muted);
    display:block;
    margin-bottom:6px;
  }
  input[type="number"], select{
    width: 100%;
    padding: 10px 12px;
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--input);
    color: var(--text);
    outline: none;
    transition: border-color .15s ease, box-shadow .15s ease;
  }
  input[type="number"]:focus, select:focus{
    border-color: var(--accent-2);
    box-shadow: 0 0 0 3px rgba(56,189,248,.15);
  }
  .inline{
    display:flex; align-items:center; gap:10px;
  }
  .suffix{
    padding: 10px 12px;
    background: #0a0f1d;
    border: 1px solid var(--border);
    border-radius: 10px;
    color: var(--muted);
    font-size: 12px;
    white-space: nowrap;
  }
  .help{
    color: var(--muted);
    font-size: 12px;
    margin-top:4px;
  }
  .btn{
    background: linear-gradient(180deg, var(--accent), #16a34a);
    color: #06200f;
    font-weight: 700;
    border: none;
    padding: 10px 14px;
    border-radius: 10px;
    cursor: pointer;
    transition: transform .06s ease, filter .2s ease;
  }
  .btn:active{ transform: translateY(1px) }
  .btn.secondary{
    background: #0a0f1d;
    color: #d1d5db;
    border: 1px solid var(--border);
  }
  .summary{
    display:grid; gap:10px;
  }
  .kpi{
    background: linear-gradient(180deg, rgba(56,189,248,.08), rgba(34,197,94,.05));
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 12px;
  }
  .kpi h3{
    margin:0 0 4px;
    font-size:14px; color:#c7d2fe;
  }
  .kpi .value{
    font-size: clamp(18px, 4vw, 28px);
    font-weight: 800;
    letter-spacing:.3px;
  }
  .kpi small{
    display:block; color: var(--muted); margin-top:4px;
  }
  .divider{
    height:1px; background: var(--border); margin: 10px 0;
  }
  .tag{
    display:inline-flex; align-items:center; gap:6px;
    background:#091227;
    border: 1px solid var(--border);
    padding:6px 10px; border-radius:999px; color:#cbd5e1;
    font-size:12px;
  }
  .tag .dot{
    width:8px; height:8px; border-radius:50%; background: var(--accent);
  }
  .row-end{
    display:flex; gap:10px; justify-content:flex-end; flex-wrap: wrap;
  }
  .muted{
    color: var(--muted);
  }
  .note{
    font-size: 12px; color: var(--muted);
  }
  .warning{
    color: var(--warn);
  }
  .danger{
    color: var(--danger);
  }
  .flex{
    display:flex; gap:10px; flex-wrap:wrap; align-items:center;
  }
  .small{
    font-size:12px;
  }
</style>
</head>
<body>

<!-- Logo -->
<img src="logo.png" alt="DeTech Logo" class="logo">

<header>
  <h1>DeTech — Cost vs. Profit Margin Calculator</h1>
  <p class="sub">Model hardware cost, onboarding travel cost per tank, and monthly subscription by contract term.</p>
</header>

<div class="container">
  <!-- Inputs -->
  <section class="card">
    <div class="section-title">Inputs</div>
    <div class="grid">
      <div class="grid grid-2">
        <div>
          <label>Hardware Cost (one-time)</label>
          <div class="inline">
            <span class="suffix">$</span>
            <input id="hardwareCost" type="number" min="0" step="1" value="950" />
          </div>
          <div class="help">Default from your note: $950 per hardware unit.</div>
        </div>

        <div>
          <label>Number of Tanks (units deployed)</label>
          <input id="numTanks" type="number" min="1" step="1" value="1" />
          <div class="help">Used to scale travel cost and monthly revenue if billed per tank.</div>
        </div>
      </div>

      <div class="grid grid-2">
        <div>
          <label>Onboarding Travel Cost per Tank</label>
          <div class="inline">
            <span class="suffix">$</span>
            <input id="travelPerTank" type="number" min="0" step="1" value="750" />
          </div>
          <div class="help">Range reference: $750 to $2200 per tank.</div>
        </div>

        <div>
          <label>Bill Monthly Per Tank?</label>
          <select id="billPerTank">
            <option value="yes" selected>Yes (monthly fee per tank)</option>
            <option value="no">No (monthly fee per facility)</option>
          </select>
          <div class="help">If "No", monthly fee is charged once per facility regardless of tank count.</div>
        </div>
      </div>

      <div>
        <label>Contract Term</label>
        <div class="row">
          <button class="btn secondary" data-term="1">1 Year ($175/mo)</button>
          <button class="btn secondary" data-term="3">3 Years ($165/mo)</button>
          <button class="btn secondary" data-term="5">5 Years ($145/mo)</button>
        </div>
        <div class="help">Click to choose. You can override the monthly rate below if needed.</div>
      </div>

      <div class="grid grid-2">
        <div>
          <label>Monthly Subscription Rate</label>
          <div class="inline">
            <span class="suffix">$</span>
            <input id="monthlyRate" type="number" min="0" step="1" value="175" />
          </div>
          <div class="help">Defaults: $175 (1yr), $165 (3yr), $145 (5yr).</div>
        </div>
        <div>
          <label>Contract Length (months)</label>
          <input id="contractMonths" type="number" min="1" step="1" value="12" />
          <div class="help">1yr=12, 3yr=36, 5yr=60.</div>
        </div>
      </div>

      <details>
        <summary class="tag"><span class="dot"></span> Optional Advanced Costs</summary>
        <div class="grid grid-2" style="margin-top:10px">
          <div>
            <label>Ongoing Monthly Cost to Serve (per tank)</label>
            <div class="inline">
              <span class="suffix">$</span>
              <input id="cogsMonthlyPerTank" type="number" min="0" step="1" value="0" />
            </div>
            <div class="help">Your internal support/telemetry costs per tank per month, if any.</div>
          </div>
          <div>
            <label>One-time Misc. Costs (per facility)</label>
            <div class="inline">
              <span class="suffix">$</span>
              <input id="miscOnetime" type="number" min="0" step="1" value="0" />
            </div>
            <div class="help">Training, shipping, install materials, etc.</div>
          </div>
        </div>
      </details>

      <div class="row-end">
        <button id="presetLow" class="btn secondary">Preset: Low Travel ($750)</button>
        <button id="presetHigh" class="btn secondary">Preset: High Travel ($2200)</button>
        <button id="reset" class="btn secondary">Reset</button>
        <button id="calc" class="btn">Calculate</button>
      </div>
    </div>
  </section>

  <!-- Outputs -->
  <section class="card">
    <div class="section-title">Results</div>
    <div class="summary">
      <div class="kpi">
        <h3>Total Revenue (Contract Term)</h3>
        <div class="value" id="revTotal">$0</div>
        <small id="revBreakdown" class="muted"></small>
      </div>

      <div class="kpi">
        <h3>Total Costs (One-time + Ongoing)</h3>
        <div class="value" id="costTotal">$0</div>
        <small id="costBreakdown" class="muted"></small>
      </div>

      <div class="kpi">
        <h3>Total Profit</h3>
        <div class="value" id="profitTotal">$0</div>
        <small id="profitNote" class="muted"></small>
      </div>

      <div class="kpi">
        <h3>Gross Margin</h3>
        <div class="value" id="marginPct">0%</div>
        <small class="muted">Profit ÷ Revenue</small>
      </div>

      <div class="divider"></div>

      <div class="grid grid-2">
        <div class="kpi">
          <h3>Monthly Recurring Revenue</h3>
          <div class="value" id="mrr">$0</div>
          <small id="mrrNote" class="muted"></small>
        </div>
        <div class="kpi">
          <h3>Monthly Profit</h3>
          <div class="value" id="pm">$0</div>
          <small id="pmNote" class="muted"></small>
        </div>
      </div>

      <div class="divider"></div>

      <div class="flex small">
        <span class="tag"><span class="dot"></span> Breakeven Month: <strong id="breakeven">—</strong></span>
        <span class="tag"><span class="dot" style="background:var(--accent-2)"></span> One-time CAC: <strong id="cac">$0</strong></span>
        <span class="tag"><span class="dot" style="background:var(--warn)"></span> Notes: <span id="notes" class="muted" style="margin-left:6px">Choose a preset or calculate.</span></span>
      </div>

      <p class="note">Assumes one hardware unit per facility by default. If you deploy a unit per tank, increase hardware cost proportionally or use "Number of Tanks" to scale monthly revenue and travel cost only.</p>
    </div>
  </section>
</div>

<script>
  const $ = (id)=>document.getElementById(id);

  const termButtons = document.querySelectorAll('button[data-term]');
  termButtons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const years = parseInt(btn.dataset.term,10);
      if(years===1){ $('monthlyRate').value = 175; $('contractMonths').value = 12; }
      if(years===3){ $('monthlyRate').value = 165; $('contractMonths').value = 36; }
      if(years===5){ $('monthlyRate').value = 145; $('contractMonths').value = 60; }
      pulse(btn);
      compute();
    });
  });

  $('presetLow').addEventListener('click', ()=>{ $('travelPerTank').value = 750; pulse($('presetLow')); compute(); });
  $('presetHigh').addEventListener('click', ()=>{ $('travelPerTank').value = 2200; pulse($('presetHigh')); compute(); });
  $('reset').addEventListener('click', ()=>{
    $('hardwareCost').value = 950;
    $('numTanks').value = 1;
    $('travelPerTank').value = 750;
    $('billPerTank').value = 'yes';
    $('monthlyRate').value = 175;
    $('contractMonths').value = 12;
    $('cogsMonthlyPerTank').value = 0;
    $('miscOnetime').value = 0;
    compute();
  });
  $('calc').addEventListener('click', compute);

  const fmt = (n)=> n.toLocaleString(undefined,{ style:'currency', currency:'USD', maximumFractionDigits:0 });
  const pct = (n)=> (isFinite(n)? (n*100).toFixed(1) : '0.0')+'%';

  function compute(){
    const hardwareCost = +$('hardwareCost').value || 0;
    const numTanks     = Math.max(1, Math.floor(+$('numTanks').value || 0));
    const travelPerTank= +$('travelPerTank').value || 0;
    const billPerTank  = $('billPerTank').value === 'yes';
    const monthlyRate  = +$('monthlyRate').value || 0;
    const contractMonths = Math.max(1, Math.floor(+$('contractMonths').value || 0));
    const cogsMonthlyPerTank = +$('cogsMonthlyPerTank').value || 0;
    const miscOnetime = +$('miscOnetime').value || 0;

    const mrr = billPerTank ? monthlyRate * numTanks : monthlyRate;
    const revenueTotal = mrr * contractMonths;

    const oneTimeTravel = travelPerTank * numTanks;
    const oneTimeCosts = hardwareCost + oneTimeTravel + miscOnetime;
    const ongoingMonthlyCost = cogsMonthlyPerTank * (billPerTank ? numTanks : 1);
    const ongoingTotal = ongoingMonthlyCost * contractMonths;
    const totalCosts = oneTimeCosts + ongoingTotal;

    const totalProfit = revenueTotal - totalCosts;
    const grossMargin = revenueTotal>0 ? (totalProfit / revenueTotal) : 0;
    const monthlyProfit = mrr - ongoingMonthlyCost;

    let breakeven = '—';
    if (monthlyProfit > 0){
      const monthsToBE = Math.ceil(oneTimeCosts / monthlyProfit);
      breakeven = monthsToBE + (monthsToBE===1 ? ' month' : ' months');
    } else if (monthlyProfit === 0 && oneTimeCosts>0){
      breakeven = 'Never (no monthly contribution)';
    } else if (oneTimeCosts===0){
      breakeven = '0 (no one-time costs)';
    }

    $('revTotal').textContent = fmt(revenueTotal);
    $('revBreakdown').textContent = `${fmt(mrr)} × ${contractMonths} months`;
    $('costTotal').textContent = fmt(totalCosts);
    $('costBreakdown').textContent = `${fmt(oneTimeCosts)} one-time + ${fmt(ongoingTotal)} ongoing`;
    $('profitTotal').textContent = fmt(totalProfit);
    $('marginPct').textContent = pct(grossMargin);
    $('mrr').textContent = fmt(mrr);
    $('pm').textContent = fmt(monthlyProfit);
    $('breakeven').textContent = breakeven;
    $('cac').textContent = fmt(oneTimeCosts);
    $('notes').textContent = billPerTank ? 'Monthly billed per tank' : 'Monthly billed per facility';
    $('mrrNote').textContent = billPerTank ? `Per tank × ${numTanks}` : 'Per facility';
    $('pmNote').textContent = `MRR minus monthly COGS`;
    $('profitNote').textContent = `Revenue minus Total Costs`;
  }

  function pulse(el){
    el.style.transform='scale(1.05)';
    setTimeout(()=>el.style.transform='scale(1)',150);
  }

  compute();
</script>

</body>
</html>
